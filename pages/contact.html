<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>

        <link
            rel="stylesheet"
            as="style"
            crossorigin
            href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css"
        />

        <link
            href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css"
            rel="stylesheet"
        />

        <link
            href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&display=swap"
            rel="stylesheet"
        />

        <link rel="stylesheet" href="css/contact.css" />
    </head>
    <body>
        <!-- con섹션1 -->
        <section id="contact">
            <video autoplay muted loop playsinline>
                <source src="img/contact/pn5_video.mp4" type="video/mp4" />
            </video>

            <div class="contactText">
                <h1>CONTACT</h1>
                <p style="font-size: 22px">CONTACT</p>
            </div>
        </section>

        <!-- con 섹션2 -->
        <section id="contact_2">
            <div class="con2_outBox">
                <div class="con2_LeftBox">
                    <div class="con2_ImgBox">
                        <img src="img/contact/m51_img.jpg" alt="con문의사진" />
                        <img
                            class="conLog"
                            src="img/contact/m11_btmVisual_logo.png"
                            alt="con로고"
                        />
                        <h3><span>VYOR</span>에게 지금 바로 문의하세요.</h3>
                    </div>
                </div>

                <div class="con2_RightBox">
                    <div class="con2_Right_InBox">
                        <div>이름</div>
                        <input type="text" />

                        <div>이메일</div>
                        <input type="text" />

                        <div>연락처</div>
                        <input type="text" />

                        <div>제목</div>
                        <input type="text" />

                        <div>내용</div>
                        <textarea></textarea>
                    </div>

                    <div id="conBtnTxt">
                        Inquiry <i class="ri-arrow-right-line"></i>
                    </div>
                </div>

                <!-- 빈박스 -->
                <div class="con2_bottomBox"></div>
            </div>
        </section>

        <!-- 팝업창 구조 -->
        <div id="popupOverlay">
            <div class="popupBox">
                <div class="popupClose">×</div>

                <p>고객님의 문의가 정상적으로 등록되었습니다.</p>
                <p>담당자가 내용을 확인 후 빠르게 연락드리겠습니다.</p>
                <br />
                <h2>VYOR에 관심 가져주셔서 진심으로 감사드립니다.</h2>
            </div>
        </div>

        <!-- con섹션1 -->

        <script>
            (function () {
                const sec = document.getElementById("contact");
                const txt = sec?.querySelector(".contactText");

                let ready = false;
                let rafId = null;

                if (txt) {
                    txt.addEventListener("animationend", () => {
                        txt.style.animation = "none";
                        txt.style.transform = "translateY(0)";
                        ready = true;
                        onScroll();
                    });
                } else {
                    ready = true;
                }

                function applyProgress(progress) {
                    if (!txt) return;
                    const vw = window.innerWidth;
                    const startLeft = 0.05 * vw;
                    const endLeft = -0.55 * vw;
                    const eased = 1 - Math.pow(1 - progress, 0.1);
                    const opacity = 1 - Math.pow(progress, 1.3);
                    const left = startLeft + (endLeft - startLeft) * eased;
                    txt.style.left = left + "px";
                    txt.style.opacity = opacity.toFixed(3);
                }

                function onScroll() {
                    if (!ready) return;
                    if (rafId) return;

                    rafId = requestAnimationFrame(() => {
                        rafId = null;
                        const rect = sec.getBoundingClientRect();
                        const vh = window.innerHeight;
                        const startY = vh * 0.9;
                        const endY = vh * 0.05;
                        let progress = (startY - rect.bottom) / (startY - endY);
                        progress = Math.min(Math.max(progress, 0), 1);
                        if (progress < 0.02) progress = 0;
                        if (progress > 0.98) progress = 1;
                        applyProgress(progress);
                    });
                }

                window.addEventListener("scroll", onScroll, { passive: true });
                window.addEventListener("resize", onScroll, { passive: true });

                // 2. 팝업 열기
                const inquiryBtn = document.getElementById("conBtnTxt");
                const popupOverlay = document.getElementById("popupOverlay");
                const popupClose = popupOverlay?.querySelector(".popupClose");

                if (inquiryBtn && popupOverlay) {
                    inquiryBtn.style.cursor = "pointer";

                    inquiryBtn.addEventListener("click", () => {
                        const inputs = document.querySelectorAll(
                            ".con2_Right_InBox input, .con2_Right_InBox textarea"
                        );
                        let allFilled = true;
                        inputs.forEach((input) => {
                            if (!input.value.trim()) allFilled = false;
                        });

                        if (!allFilled) {
                            alert("입력란을 모두 채워주세요");
                            return;
                        }

                        popupOverlay.classList.add("show");
                    });
                }

                if (popupClose && popupOverlay) {
                    popupClose.addEventListener("click", () => {
                        popupOverlay.classList.remove("show");
                    });

                    popupOverlay.addEventListener("click", (e) => {
                        if (e.target === popupOverlay) {
                            popupOverlay.classList.remove("show");
                        }
                    });
                }
            })();
        </script>
    </body>
</html>
